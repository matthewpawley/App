$(function(){function e(){i.zoomToIndexes(n.length-40,n.length-1)}function t(){var e=[],t=new Date;t.setDate(t.getDate()-5);for(var a=0;1e3>a;a++){var r=new Date(t);r.setDate(r.getDate()+a);var o=Math.round(Math.random()*(40+a/5))+20+a;e.push({date:r,visits:o})}return e}var a=$("main.container").royalSlider({sliderDrag:!1,sliderTouch:!1,navigateByClick:!1}).data("royalSlider");a.ev.on("rsAfterSlideChange",function(){var e=$(a.currSlide.content.get(0)),t=e.attr("id"),r=$("#fixed-footer a[href=#"+t+"]");$("#fixed-footer a").removeClass("selected"),r.addClass("selected")}),$(document).on("click touchstart",".link",function(e){e.preventDefault();var t=$(this),r=$(t.attr("href")).parent(),o=r.index();a.goTo(o),$("#fixed-footer a").removeClass("selected"),$("#fixed-footer a[href="+t.attr("href")+"]").addClass("selected")});var r=$(".workouts-slider").royalSlider({sliderDrag:!1,sliderTouch:!1,navigateByClick:!1}).data("royalSlider");r.ev.on("rsAfterSlideChange",function(){var e=$(r.currSlide.content.get(0)),t=e.attr("id"),a=$(".workout-pagination a[href=#"+t+"]");$(".workout-pagination a").removeClass("selected"),a.addClass("selected")}),$(document).on("click touchstart",".workout-link",function(e){e.preventDefault();var t=$(this),a=$(t.attr("href")).parent(),o=a.index();r.goTo(o),$(".workout-pagination a").removeClass("selected"),$(".workout-pagination a[href="+t.attr("href")+"]").addClass("selected")});var o={};o.webdb={},o.webdb.db=null,o.webdb.open=function(){var e=5242880;o.webdb.db=openDatabase("gym-tracker","1","Gym Tracker",e)},o.webdb.onError=function(e,t){alert("There has been an error: "+t.message)},o.webdb.createTable=function(){var e=o.webdb.db;e.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS workouts(ID INTEGER PRIMARY KEY ASC, start_time int, end_time int)",[])})},$(".workout-toggle").on("mousedown touchstart",function(e){e.preventDefault(),o.webdb.checkRunningSession()}),o.webdb.startSession=function(){var e=o.webdb.db;e.transaction(function(e){new Date;e.executeSql("INSERT INTO workouts(start_time) VALUES (?)",[(new Date).getTime()],o.webdb.loadData,o.webdb.onError)}),$("#timer").removeClass("paused").addClass("running"),$(".workout-toggle").text("Stop Workout")},o.webdb.endSession=function(){var e=o.webdb.db;e.transaction(function(e){new Date;e.executeSql("UPDATE workouts SET end_time=? WHERE end_time IS NULL",[(new Date).getTime()],o.webdb.loadData,o.webdb.onError)}),$("#timer").removeClass("running").addClass("paused"),$(".workout-toggle").text("Start Workout")},o.webdb.sessionToggle=function(e,t){t.rows.length>0?o.webdb.endSession():o.webdb.startSession()},o.webdb.checkRunningSession=function(){var e=o.webdb.db;e.transaction(function(e){e.executeSql("SELECT id FROM workouts WHERE end_time IS NULL",[],o.webdb.sessionToggle,o.webdb.onError)})},o.webdb.loadData=function(){var e=o.webdb.db;e.transaction(function(e){e.executeSql("SELECT * FROM workouts ORDER BY start_time DESC",[],o.webdb.output,o.webdb.onError)})},o.webdb.output=function(e,t){html="";for(var a=0;a<t.rows.length;a++){var r=t.rows.item(a),o=new Date(r.start_time),n=new Date(r.end_time),i=Math.abs(n.getTime()-o.getTime()),s=Math.floor(i/36e5),d=Math.ceil(i/6e4-60*s),l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];html+="<tr><td>"+o.getDay()+" "+l[o.getMonth()]+" "+o.getHours()+":"+o.getMinutes()+"</td><td>"+(r.end_time?s+" hours, "+d+" minutes":"In progress")+"</td></tr>"}$("#workouts").find("tbody").html(html)};var n=t(),i=AmCharts.makeChart("chartdiv",{type:"serial",theme:"light",pathToImages:"http://www.amcharts.com/lib/3/images/",dataProvider:n,valueAxes:[{axisAlpha:.2,dashLength:1,position:"left"}],graphs:[{id:"g1",balloonText:"[[category]]<br /><b><span style='font-size:14px;'>value: [[value]]</span></b>",bullet:"round",bulletBorderAlpha:1,bulletColor:"#FFFFFF",hideBulletsCount:50,title:"red line",valueField:"visits",useLineColorForBulletBorder:!0}],chartScrollbar:{autoGridCount:!0,graph:"g1",scrollbarHeight:40},chartCursor:{cursorPosition:"mouse"},categoryField:"date",categoryAxis:{parseDates:!0,axisColor:"#DADADA",dashLength:1,minorGridEnabled:!0},exportConfig:{menuRight:"20px",menuBottom:"30px",menuItems:[{icon:"http://www.amcharts.com/lib/3/images/export.png",format:"png"}]}});i.addListener("rendered",e),e(),o.webdb.open(),o.webdb.createTable(),o.webdb.loadData()});